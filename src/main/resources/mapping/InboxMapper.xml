<?xml version="1.0" encoding="UTF-8" ?>
        <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hx.dao.InboxMapper" >
    <resultMap id="BaseResultMap" type="com.hx.modle.Inbox" >
        <id property="id" column="id"/>
        <result property="senderunit" column="senderunit"/>
        <result property="receivenumber" column="receivenumber"/>
        <result property="create_time" column="create_time"/>
        <result property="senderunit" column="senderunit"/>
        <result property="isreceipt" column="isreceipt"/>
        <result property="sendernumber" column="sendernumber"/>
        <result property="filsavepath" column="filsavepath"/>
        <result property="isLink" column="isLink"/>
        <result property="barCode" column="barCode"/>
    </resultMap>

    <delete id="deinbox">
       DELETE FROM inbox WHERE id = #{id}
    </delete>
    <select id="getAll" resultType="com.hx.modle.Inbox">
        SELECT*
        FROM inbox
        where id in
        <foreach collection="ids" item="id" open="(" close=")" separator=",">
            #{id}
        </foreach>
    </select>
    <select id="queryALLMaillist" parameterType="java.util.Map" resultType="com.hx.modle.Inbox">
        SELECT * FROM inbox WHERE
        create_time BETWEEN date_format(#{beginDate},'%Y-%m-%d') AND date_format(#{endDate},'%Y-%m-%d')
        <if test="mailListId!=null">
        AND senderunit LIKE '% ${mailListId}%'
        </if>
    </select>

    <select id="queryTotalCount" resultType="int">
        SELECT COUNT(*) FROM inbox where 1 = 1

        <if  test="params.senderunit!=null and params.senderunit!=''">
            and  senderunit  LIKE CONCAT('%',#{params.senderunit},'%')
        </if>
        <if  test="params.receivenumber!=null and params.receivenumber!=''">
            and  receivenumber  LIKE CONCAT('%',#{params.receivenumber},'%')
        </if>
        <if  test="params.beginDate!=null and params.beginDate!=''">
            and create_time &gt;=  #{params.beginDate}
        </if>
        <if  test="params.endDate!=null and params.endDate!=''">
            and create_time &lt;=  #{params.endDate}
        </if>
        <if test="params.Isreceipt!=null">
            and  Isreceipt   = #{params.Isreceipt}
        </if>
    </select>

    <select id="queryALLMail" parameterType="java.util.Map" resultType="com.hx.modle.Inbox">
        SELECT * FROM inbox where 1 = 1

        <if  test="params.sendernumber!=null and params.sendernumber!=''">
            and  sendernumber  LIKE CONCAT('%',#{params.sendernumber},'%')
        </if>
        <if  test="params.senderunit!=null and params.senderunit!=''">
            and  senderunit  LIKE CONCAT('%',#{params.senderunit},'%')
        </if>
        <if  test="params.receivenumber!=null and params.receivenumber!=''">
            and  receivenumber  LIKE CONCAT('%',#{params.receivenumber},'%')
        </if>
        <if  test="params.beginDate!=null and params.beginDate!=''">
            and create_time &gt;=  #{params.beginDate}
        </if>
        <if  test="params.endDate!=null and params.endDate!=''">
            and create_time &lt;=  #{params.endDate}
        </if>
        <if test="params.Isreceipt!=null">
            and  Isreceipt   = #{params.Isreceipt}
        </if>
        LIMIT ${params.start}, ${params.offset}
    </select>

    <select id="queryALLMailList" resultType="com.hx.modle.Inbox">
        select  * from inbox
    </select>



    <select id="getById" resultType="com.hx.modle.Inbox">
      select
        id, sendernumber, senderunit, receivenumber, filsavepath, create_time, receiptpath, Isreceipt
        from inbox where id = #{id}
        </select>

    <select id="queryinboxCount" resultType="java.lang.Integer">
      select * from table limit (start-1)*limit
    </select>



    <insert id="insert" parameterType="com.hx.modle.Inbox">
        INSERT INTO inbox(id, sendernumber, senderunit, receivenumber, filsavepath, create_time, receiptpath, Isreceipt) VALUES (
          #{inbox.id},
          #{inbox.sendernumber},
          #{inbox.senderunit},
          #{inbox.receivenumber},
          #{inbox.filsavepath},
          #{inbox.create_time},
          #{inbox.receiptpath},
          #{inbox.isreceipt}
        )
    </insert>
    <!--张立恒start-->
    <!--新增收件箱-->
    <insert id="insertInbox" parameterType="com.hx.modle.Inbox">
        INSERT INTO inbox
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="sendernumber != null and sendernumber != ''">
                sendernumber,
            </if>
            <if test="receivenumber != null and receivenumber != ''">
                receivenumber,
            </if>
            <if test="filsavepath != null and filsavepath != ''">
                filsavepath,
            </if>
            <if test="create_time != null and create_time != ''">
                create_time,
            </if>
            <if test="receiptpath != null and receiptpath != ''">
                receiptpath,
            </if>
            <if test="senderunit != null and senderunit != ''">
                senderunit,
            </if>
        </trim>
        <trim prefix=" values (" suffix=")" suffixOverrides=",">
            <if test="sendernumber != null and sendernumber != ''">
                #{sendernumber,jdbcType=VARCHAR},
            </if>
            <if test="receivenumber != null and receivenumber != ''">
                #{receivenumber,jdbcType=VARCHAR},
            </if>
            <if test="filsavepath != null and filsavepath != ''">
                #{filsavepath,jdbcType=VARCHAR},
            </if>
            <if test="create_time != null and create_time != ''">
                #{create_time,jdbcType=TIMESTAMP},
            </if>
            <if test="receiptpath != null and receiptpath != ''">
                #{receiptpath,jdbcType=VARCHAR},
            </if>
            <if test="senderunit != null and senderunit != ''">
                #{senderunit,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <!--修改是否已回执,改成已回执:1-->
    <update id="updateIsReceiptById" parameterType="java.lang.Integer">
      UPDATE inbox SET Isreceipt=1 WHERE id=#{id,jdbcType=INTEGER}
    </update>
    <update id="updateIsReceiptByBarCode" parameterType="java.lang.String">
      UPDATE inbox SET Isreceipt=1 WHERE barCode=#{barCode,jdbcType=VARCHAR}
    </update>
    <!--修改是否已关联,改成已关联:1-->
    <update id="updateIsLink" parameterType="java.lang.Integer">
      UPDATE inbox SET isLink=1 WHERE id=#{id,jdbcType=INTEGER}
    </update>
    <!--查询一次正文路径,改成已关联:1-->
    <select id="selectTifPath" resultType="java.lang.String" parameterType="java.lang.Integer">
      SELECT filsavepath FROM inbox WHERE id=#{id,jdbcType=INTEGER}
    </select>
    <!--张立恒end-->
</mapper>